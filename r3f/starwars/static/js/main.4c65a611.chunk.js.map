{"version":3,"sources":["assets/star_wars.mp4","App.js","index.js"],"names":["Box","props","scale","rotation","position","attach","color","GenerateTestPattern","canvasref","useRef","videoref","React","useState","colorBoxes","setColorBoxes","useLayoutEffect","current","src","videofile","addEventListener","console","log","setTimeout","ctx","getContext","drawImage","w","h","data","getImageData","colorMap","i","newWidth","r","g","b","a","createColorMap","map","cm","arr","toString","slice","camera","fov","near","far","intensity","angle","ref","controls","style","top","autoplay","display","App","ReactDOM","render","document","getElementById"],"mappings":"4OAAe,G,MAAA,IAA0B,uCCgBzC,SAASA,EAAIC,GACX,OACE,uBACEC,MAAOD,EAAMC,MACbC,SAAU,CAAC,EAAG,EAAG,GACjBC,SAAUH,EAAMG,SAHlB,UAKE,mCAAmBC,OAAO,aAC1B,qCAAqBA,OAAO,WAAWC,MAAOL,EAAMK,WAK1D,SAASC,IACP,IAAMC,EAAYC,mBACZC,EAAWD,mBAFY,EAIOE,IAAMC,SAAS,IAJtB,mBAItBC,EAJsB,KAIVC,EAJU,KAoI7B,OA9HAH,IAAMI,iBAAgB,WACpBL,EAASM,QAAQC,IAAMC,EAEvBR,EAASM,QAAQG,iBAAiB,cAAc,WAC9CC,QAAQC,IAAI,gBAEd,IAEFC,YAKA,WAEE,IAAMC,EAAMf,EAAUQ,QAAQQ,WAAW,MAQzCD,EAAIE,UAAUf,EAASM,QAAS,EAAG,EAFhBU,GADAC,IAKnB,IAgBMC,EADUL,EAAIM,aAAa,EAAG,EAnBjBH,GADAC,IAqBEC,KAkBrB,IAGMf,EAhBN,WAEE,IADA,IAAIiB,EAAW,GACPC,EAAI,EAAGA,EAAKC,MAA4BD,GALnC,EAKgD,CAC3D,IAAME,EAAIL,EAAKG,GACTG,EAAIN,EAAKG,EAAI,GACbI,EAAIP,EAAKG,EAAI,GACbK,EAAIR,EAAKG,EAAI,GACnBD,EAASC,GAAK,CAACE,EAAEC,EAAEC,EAAEC,GAGvB,OAAON,EAMUO,GAAiBC,KAAI,SAACC,EAAIR,GAAL,OAEpC,cAAC/B,EAAD,CAEEE,MAAO,CAAC,KAAM,MAAOqC,EAAG,GAAGA,EAAG,GAAGA,EAAG,IAAI,KACxCnC,SAAU,EAAG2B,EAAE,IAAmBC,KARxB,MAQgDD,EA/C7CJ,MA+CoE,KAPvE,GAOuFY,EAAG,GAAGA,EAAG,GAAGA,EAAG,IAAI,IACpHjC,OAhGQkC,EAgGQD,EA3FjB,KAAO,UAJFC,EAAI,IAGI,GAFNA,EAAI,IAEkB,EADvBA,EAAI,IACiC,IACnBC,SAAS,IAAIC,MAAM,KAwFrCX,GA7Ff,IAAkBS,KAqGd1B,EAAcD,KAjEG,IAuHjB,qCAEE,eAAC,IAAD,CAAQ8B,OAAQ,CAAEC,IAAK,GAAIC,KAAM,GAAKC,IAAK,IAAM1C,SAAU,CAAC,EAAG,EAAG,MAAlE,UAEE,8BAAc2C,UAAW,KACzB,2BAAW3C,SAAU,CAAC,GAAI,GAAI,IAAK4C,MAAO,KACzCnC,EACD,cAAC,IAAD,OAEF,uBAAOoC,IAAKvC,EAAUwC,UAAU,EAAMC,MAAO,CAAC/C,SAAS,WAAYgD,IAAI,GAAIC,UAAQ,IACnF,wBAAQJ,IAAKzC,EAAW2C,MAAO,CAACG,QAAQ,aAM/B,SAASC,IACtB,OACE,mCACE,cAAChD,EAAD,MCjLNiD,IAASC,OAAO,cAACF,EAAD,IAASG,SAASC,eAAe,W","file":"static/js/main.4c65a611.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/star_wars.4dcdf34c.mp4\";","import React, { useRef } from \"react\";\nimport { Canvas } from \"react-three-fiber\";\nimport { OrbitControls, Stars } from \"drei\";\nimport \"./styles.css\";\n//import testpattern from './assets/testpattern_flat_400x400.jpeg'\nimport videofile from './assets/star_wars.mp4'\n\nfunction rgbToHex(arr) {\n  const red = arr[0]\n  const green = arr[1]\n  const blue = arr[2]\n  const rgb = (red << 16) | (green << 8) | (blue << 0);\n  return '#' + (0x1000000 + rgb).toString(16).slice(1);\n}\n\n\nfunction Box(props) {\n  return (\n    <mesh\n      scale={props.scale}\n      rotation={[0, 0, 0]}\n      position={props.position}\n    >\n      <boxBufferGeometry attach=\"geometry\" />\n      <meshLambertMaterial attach=\"material\" color={props.color} />\n    </mesh>\n  );\n}\n\nfunction GenerateTestPattern() {\n  const canvasref = useRef()\n  const videoref = useRef()\n\n  const [colorBoxes, setColorBoxes] = React.useState([])\n\n  React.useLayoutEffect(() => {\n    videoref.current.src = videofile\n    \n    videoref.current.addEventListener('loadeddata', function() {\n      console.log('playing')\n    });\n  },[])\n\n  setTimeout(update, 1000/20)\n\n  \n  \n\n  function update() {\n\n    const ctx = canvasref.current.getContext('2d')\n\n    const h = 23\n    const w = 32\n\n    const h_adjusted = h * 3/1.5\n    const w_adjusted = w * 3/1.5\n    \n    ctx.drawImage(videoref.current, 0, 0, w_adjusted, h_adjusted);\n    \n    const newWidth = w_adjusted //* io.width \n    const newHeight = h_adjusted //* io.height\n    \n    //let scale = 1\n    //const io = new Image();\n    \n    //ctx.drawImage(io, 0, 0)\n    //ctx.scale(scale, scale)\n\n    // if (scale == 0.5) {\n    //   ctx.scale(scale, scale)\n    // }\n\n    // scale = 1\n    \n    const imgData = ctx.getImageData(0, 0, newWidth, newHeight)\n    const data = imgData.data\n\n    const pixels = 4\n    \n\n    function createColorMap() {\n      let colorMap = []\n      for(let i = 0; i < (newWidth*newHeight*pixels); i += pixels) {\n        const r = data[i];\n        const g = data[i + 1];\n        const b = data[i + 2];\n        const a = data[i + 3];\n        colorMap[i] = [r,g,b,a]\n      }\n      //console.log(colorMap)\n      return colorMap\n    }\n\n    const scalerX = 4.7\n    const scalerY = 6\n\n    const colorBoxes = createColorMap().map((cm, i) =>\n      (\n        <Box \n          key={i} \n          scale={[0.666,0.666,(cm[0]+cm[1]+cm[2])/100]} \n          position={[ (i%(newWidth*pixels)-(newWidth*2))/scalerX, (-i/newHeight+(newHeight*2.6))/scalerY, (cm[0]+cm[1]+cm[2])/50]} \n          color={rgbToHex(cm)} \n        />\n      )\n    )\n\n    setColorBoxes(colorBoxes)\n\n    // wait for the browser to be ready to present another animation fram.       \n  }\n\n  // React.useEffect(() => {\n  //   const io = new Image();\n  //   io.src = testpattern;\n\n    \n  \n  //   io.onload = () => {\n  //     console.log('image did load')\n  //     const ctx = canvasref.current.getContext('2d')\n  //     const scale = 0.1\n  //     const newWidth = scale * io.width \n  //     const newHeight = scale * io.height\n      \n  //     ctx.scale(scale, scale)\n  //     ctx.drawImage(io, 0, 0)\n      \n  //     const imgData = ctx.getImageData(0, 0, newWidth, newHeight)\n  //     const data = imgData.data\n\n  //     function createColorMap() {\n  //       let colorMap = []\n  //       for(let i = 0; i < (newWidth*newHeight*4); i += 4) {\n  //         const r = data[i];\n  //         const g = data[i + 1];\n  //         const b = data[i + 2];\n  //         const a = data[i + 3];\n  //         colorMap[i] = [r,g,b,a]\n  //       }\n  //       //console.log(colorMap)\n  //       return colorMap\n  //     }\n\n  //     const scaler = 3\n\n  //     const colorBoxes = createColorMap().map((cm, i) =>\n  //       (\n  //         <Box key={i} scale={[1,1,cm[0]/50]} position={[ (i%(newWidth*4)-(newWidth*2))/scaler, (-i/newHeight+(newHeight*2))/scaler, 0]} color={rgbToHex(cm)} />\n  //       )\n  //     )\n\n  //     setColorBoxes(colorBoxes)\n      \n  //   }\n\n    \n\n  // }, []); \n\n  return (\n    <>\n   \n      <Canvas camera={{ fov: 10, near: 0.1, far: 1000, position: [0, 0, 350] }}>\n        {/* <Stars></Stars> */}\n        <ambientLight intensity={0.5} />\n        <spotLight position={[10, 15, 10]} angle={0.3} />\n        {colorBoxes}\n        <OrbitControls></OrbitControls>\n      </Canvas>\n      <video ref={videoref} controls={true} style={{position:\"absolute\", top:0}} autoplay></video>\n      <canvas ref={canvasref} style={{display:\"none\"}}></canvas>\n    </>\n  )\n}\n\n\nexport default function App() {\n  return (\n    <>\n      <GenerateTestPattern></GenerateTestPattern>\n    </>\n  )\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}